<?php

namespace Omnipay\GlobalPayments\Message\ProPayMessage;


use GlobalPayments\Api\Entities\Enums\Environment;
use GlobalPayments\Api\ServiceConfigs\Gateways\PorticoConfig;
use GlobalPayments\Api\ServicesContainer;
use GlobalPayments\Api\Services\PayFacService;
use Omnipay\GlobalPayments\Message\HeartlandMessage\AbstractHeartlandRequest;
// use GlobalPayments\Api\Services\PayFacService;


class SplitPayRequest extends AbstractProPayRequest
{
    protected function setServicesConfig()
    {
        $config = new PorticoConfig();
        $config->certificationStr = $this->getCertificationStr();
        $config->terminalId = $this->getTerminalId();
        $config->environment = $this->getTestMode() ? Environment::TEST : Environment::PRODUCTION;
        // $config->selfSignedCertLocation = \app_path('../test-hertland.crt');

        ServicesContainer::configureService($config);
    }


    public function runTrans()
    {

        $this->setGoodResponseCodes(array('00', '10'));

dd("ASD",$this->getWithAccountNumber());


        $chargeMe = $this->gpCardObj;
        return PayFacService::splitFunds()
        ->withAccountNumber($this->getWithAccountNumber())
        ->withReceivingAccountNumber($this->getWithReceivingAccountNumber())
        ->withAmount($amount)
        ->withTransNum($this->getTransactionId())
        ->execute();
    }
}
